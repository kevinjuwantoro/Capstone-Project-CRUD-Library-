# Fungsi meminjam buku
Keranjang_Buku = []  # Keranjang Buku --> variabel sementara

from datetime import datetime

def borrow():
    input_borrow = int(input('''Menu Meminjam Buku:
1. Meminjam Buku
2. Kembali ke menu utama
Masukkan angka menu yang ingin Anda jalankan:'''))

    if input_borrow == 1:
        Tabel_Daftar_Buku(List_Daftar_Buku)
        while True:
            Borrow_Buku = str(input("\tMasukkan ID Buku yang ingin Anda pinjam:"))
            list_value = [str(value) for data_buku in List_Daftar_Buku for value in data_buku.values()]

            if Borrow_Buku not in list_value:
                print("\n\t Maaf, Data yang ingin Anda pinjam tidak ada. Silahkan meminjam Buku yang tersedia!")
            else:
                print("\n\t Data yang ingin Anda pinjam tersedia!")
                informasi_buku = CariDaftar(Borrow_Buku)
                Tabel_Daftar_Buku(informasi_buku)

                Menambahkan_keranjang = input("\n\t Tambahkan keranjang (Ya/Tidak)?").lower()
                if Menambahkan_keranjang == "ya":
                    Jumlah_Buku = int(input("\t Berapa buku yang ingin dipinjam?:"))
                    if Jumlah_Buku > informasi_buku[0]["stok_buku"]:
                        print("\n\t Mohon maaf stok buku tidak cukup")
                    else:
                        # Menggunakan "Qty" sebagai kunci untuk jumlah buku
                        buku_di_keranjang = {

                            "Judul_Buku": informasi_buku[0]["Judul_Buku"],
                            "Qty": Jumlah_Buku,
                            "ID_Buku": informasi_buku[0]["ID_Buku"],
                            "Tanggal_Pinjam": datetime.now() 
                        }

                        #keranjang buku sebagai variabel sementara saja
                        Keranjang_Buku.append(buku_di_keranjang)
                        print("\n\t Buku berhasil ditambahkan ke keranjang!")
                else:
                    print("\n\t Keranjang Buku tidak jadi diupdate")

                Tabel_Daftar_Buku_Keranjang(Keranjang_Buku)

                Mengonfirmasi_pinjaman = input("\n\t Konfirmasi pinjaman Buku yang ingin dipinjam (Ya/Tidak)?").lower()
                if Mengonfirmasi_pinjaman == "ya":
                    informasi_buku[0]["stok_buku"] -= Jumlah_Buku
                    print("\n\t Terima kasih telah meminjam buku!")
                elif Mengonfirmasi_pinjaman == "tidak":
                    print("\n\t Terima kasih!")
                else:
                    print("\n\t Tidak ada data yang tersedia, silahkan masukkan angka yang tersedia\n")
                break 

    elif input_borrow == 2:
        Menu()
    else:
        print("\n\tTidak ada data yang tersedia, silahkan masukkan angka yang tersedia\n")

    borrow()
